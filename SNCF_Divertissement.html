<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <style>
    body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0;font-family : 'Arial'; font-size: 15}
    rect { opacity:1;}
  </style>
</head>

<body>
<div>
  <script>
    // Feel free to change or delete any of the code you see in this editor!
    var margin = {top : 20,left: 0, right: 20, bottom: 20}
    
    var svg = d3.select("body").append("svg")
      .attr("width", 960)
      .attr("height", 500);

    // gare 1 selectionnée virtuellement 
    var gare1 = 713040; //384008 //713040//  
    // gare 2 selectionnée virtuellement
    var gare2 = 384008; //172007
    
    var w_rect = 18;
    var h_rect = 36;
    var x_divertissements1= 220;
    var x_divertissements2= x_divertissements1+w_rect;
    var y_divertissements = 95;
    var y_acces = 160;
    
    var couleur1 = 'green';
    var couleur2 =	'yellow';
    var couleur3 = 'lightgrey';
    
 		// définition des dimensions globalisées des carrés
    
		var histo_acces = svg.append("g");
    
    var div = d3.select("body").append("div")	
    .attr("class", "tooltip")
    .attr("width","50px")
    //.style("position","absolute")
    .style("display","inlineblock")
    .style("background-color","white")
    .style("border","1px solid grey")
    .style("border-radius","10px")
    .style("opacity", 0);
 	

// début csv
d3.csv("all-joined-datasets.csv",function(data){

  var divertissements1 = [{uic: gare1}] //json avec les divertissements en gare1
  var divertissements2 = [{uic: gare2}] //json avec les divertissements en gare2
  
  var acces1 = [{uic: gare1}] //json avec les moyens d'acces en gare1
  var acces2 = [{uic: gare2}] //json avec les moyens d'acces en gare2
  
  var motif1 = [{uic: gare1}] //json avec les motif d'arrivé en gare1
  var motif2 = [{uic: gare2}] //json avec les motif d'arrivé en gare2
  
  //parcour des données
  data.forEach(function(d){
    // text
    d.variation = (+d.voyageurs_2016-+d.voyageurs_2015)/(d.voyageurs_2015)

	if(d.Code_UIC == gare1){
		divertissements1.push({wifi: d.Wifi,
													 baby_foot: d.Baby_Foot,
													 powerstation: d.Power_Station,
													 piano: d.Piano,
													 histoires: d.Distr_Histoires_Courtes})
    
    acces1.push({voiture: +d.deux_roues_motorisees + +d.Autres_voitures_location_autopartage + +d.Voiture_Conducteur + +d.Voiture_passager,
                 taxis: +d.Taxis,
    						 bus: +d.Bus_Car_Navette,
                 metro: +d.Metro_RER,
                 tram: +d.Tramway,
    						 marche: +d.Marche,
    						 velo: +d.Velo})
    
    motif1.push({divers: +d.Demarches_administratives_medicales_ou_achat,
                 commute: +d.Deplacement_domicile_travail_habituel,
                 etudes: +d.Deplacement_domicile_etude_y_compris_stage,
    						 occasionnel: +d.Deplacement_professionnel_occasionnel,
   							 loisirs: +d.Loisirs_vacances_visite_d_un_proche_ou_ami})
  }  
	if(d.Code_UIC == gare2){
		divertissements2.push({wifi: d.Wifi,
													 baby_foot: d.Baby_Foot,
													 powerstation: d.Power_Station,
													 piano: d.Piano,
													 histoires: d.Distr_Histoires_Courtes})
    
    acces2.push({voiture: +d.deux_roues_motorisees + +d.Autres_voitures_location_autopartage + +d.Voiture_Conducteur + +d.Voiture_passager,
                 taxis: +d.Taxis,
    						 bus: +d.Bus_Car_Navette,
                 metro: +d.Metro_RER,
                 tram: +d.Tramway,
    						 marche: +d.Marche,
    						 velo: +d.Velo})
    
    motif2.push({divers: +d.Demarches_administratives_medicales_ou_achat,
                 commute: +d.Deplacement_domicile_travail_habituel,
                 etudes: +d.Deplacement_domicile_etude_y_compris_stage,
    						 occasionnel: +d.Deplacement_professionnel_occasionnel,
   							 loisirs: +d.Loisirs_vacances_visite_d_un_proche_ou_ami})
  }
	})
  if (gare1 == null && gare2 != null){
    divertissements1 = divertissements2
    acces1 = acces2
    motif1 = motif2;
  }
  else if(gare1 != null && gare2 == null){
    divertissements2 = divertissements1
    acces2 = acces1
    motif2 = motif1;
  }

  refreshText(data,gare1,gare2)
  refreshDiv(divertissements1,divertissements2)
  refreshAcces(acces1,acces2)
  d3.selectAll("rect")
          .attr("width",w_rect)
          .attr("height",h_rect)
  // utilisation des dimensions globalisées #modif


  refreshMotif(motif1,motif2)
  if(gare1==null){d3.selectAll("rect").style("fill",couleur2);}
  else if(gare2==null){d3.selectAll("rect").style("fill",couleur1);}


  ;

})
    // Définition des fonctions

    function refreshText(data,gare1,gare2){

        // emplacement du text 'nom des gares'
        svg.append("text")
            .attr("id","nom")
            .text("Nom des gares")
            .attr("y", 0 + margin.top)
            .attr("x", 0 + margin.left)
            .attr("text-anchor","start")

        // emplacement du nom de la gare 1
        svg.append("text")
            .attr("id","nom1")
            .text("")
            .attr("y", 0 + margin.top)
            .attr("x", function(){return d3.select("#nom").attr("x")+275})
            .attr("text-anchor","end")

        // emplacement du nom de la gare 2
        svg.append("text")
            .attr("id","nom2")
            .text("")
            .attr("y", 0 + margin.top)
            .attr("x", function(){return d3.select("#nom").attr("x")+350})
            .attr("text-anchor","start")


      // emplacement du text 'nombre de voyageurs'
      svg.append("text")
              .attr("id","Nombredevoyageurs")
              .text("Nombre de voyageurs")
              .attr("y", 30 + margin.top)
              .attr("x", 0 + margin.left)
              .attr("text-anchor","start")

      // emplacement de la valeur correspondante pour la gare 1
      svg.append("text")
              .attr("id","valeur_voyageurs")
              .text("")
              .attr("y", 30 + margin.top)
              .attr("x",function(){return d3.select("#Nombredevoyageurs").attr("x")+275})
              .attr("text-anchor","end")

      // emplacement de la valeur correspondante pour la gare 2
      svg.append("text")
              .attr("id","valeur_voyageurs2")
              .text("")
              .attr("y", 30 + margin.top)
              .attr("x", function(){return d3.select("#Nombredevoyageurs").attr("x")+350})
              .attr("text-anchor","start")

      // emplacement du text 'variation par rapport à 2015'
      svg.append("text")
              .attr("id","Variation")
              .text("Variation par rapport à 2015")
              .attr("y", 60 + margin.top)
              .attr("x", 0 + margin.left)
              .attr("text-anchor","start")

      // emplacement de la valeur correspondante pour la gare 1
      svg.append("text")
              .attr("id","valeur_variation")
              .text("")
              .attr("y", 78 + margin.left)
              .attr("x", function(){return d3.select("#Variation").attr("x")+275})
              .style("text-anchor","end")

      // emplacement de la valeur correspondante pour la gare 2
      svg.append("text")
              .attr("id","valeur_variation2")
              .text("")
              .attr("y", 78 + margin.left)
              .attr("x", function(){return d3.select("#Variation").attr("x")+350})
              .style("text-anchor","start")

      // emplacement du text 'Divertissement'
      svg.append("text")
              .attr("id","Wifi")
              .text("Divertissements")
              .attr("y", 100 + margin.top)
              .attr("x", 0 + margin.left)
              .attr("text-anchor","start")

      // emplacement du text "Moyens d'acces"
      svg.append("text")
              .attr("id","Moyenacces")
              .text("Moyens d'accès")
              .attr("y", 145 + margin.top)
              .attr("x", 0 + margin.left)
              .attr("text-anchor","start")

      // emplacement du text "Motif du déplacement"
      svg.append("text")
              .attr("id","Motifsdeplacements")
              .text("Motif du déplacement")
              .attr("y", 190 + margin.top)
              .attr("x", 150 )
              .attr("text-anchor","start")

      // emplacement du text 'nombre de voyageurs'
      svg.append("text")
              .attr("id","Nombredevoyageurs")
              .text("Nombre de voyageurs")
              .attr("y", 30 + margin.top)
              .attr("x", 0 + margin.left)
              .attr("text-anchor","start")

      // emplacement de la valeur correspondante pour la gare 1
      svg.append("text")
              .attr("id","valeur_voyageurs")
              .text("")
              .attr("y", 30 + margin.top)
              .attr("x",function(){return d3.select("#Nombredevoyageurs").attr("x")+275})
              .attr("text-anchor","end")

      // emplacement de la valeur correspondante pour la gare 2
      svg.append("text")
              .attr("id","valeur_voyageurs2")
              .text("")
              .attr("y", 30 + margin.top)
              .attr("x", function(){return d3.select("#Nombredevoyageurs").attr("x")+350})
              .attr("text-anchor","start")

      // emplacement du text 'variation par rapport à 2015'
      svg.append("text")
              .attr("id","Variation")
              .text("Variation par rapport à 2015")
              .attr("y", 60 + margin.top)
              .attr("x", 0 + margin.left)
              .attr("text-anchor","start")

      // emplacement de la valeur correspondante pour la gare 1
      svg.append("text")
              .attr("id","valeur_variation")
              .text("")
              .attr("y", 78 + margin.left)
              .attr("x", function(){return d3.select("#Variation").attr("x")+275})
              .style("text-anchor","end")

      // emplacement de la valeur correspondante pour la gare 2
      svg.append("text")
              .attr("id","valeur_variation2")
              .text("")
              .attr("y", 78 + margin.left)
              .attr("x", function(){return d3.select("#Variation").attr("x")+350})
              .style("text-anchor","start")

      // emplacement du text 'Divertissement'
      svg.append("text")
              .attr("id","Wifi")
              .text("Divertissements")
              .attr("y", 100 + margin.top)
              .attr("x", 0 + margin.left)
              .attr("text-anchor","start")

      // emplacement du text "Moyens d'acces"
      svg.append("text")
              .attr("id","Moyenacces")
              .text("Moyens d'accès")
              .attr("y", 145 + margin.top)
              .attr("x", 0 + margin.left)
              .attr("text-anchor","start")

      // emplacement du text "Motif du déplacement"
      svg.append("text")
              .attr("id","Motifsdeplacements")
              .text("Motif du déplacement")
              .attr("y", 190 + margin.top)
              .attr("x", 150 )
              .attr("text-anchor","start")

      //  emplacements des texts
      svg.append("text")
              .attr("id","valeur_rang")
              .attr("y", 50 + margin.left)
              .attr("x", function(){return d3.select("#valeur_voyageurs").attr("x")})
              .style("text-anchor","start")

      // emplacement du rang pour la gare 2
      svg.append("text")
              .attr("id","valeur_rang2")
              .attr("y", 50 + margin.left)
              .attr("x",function(){return +d3.select("#valeur_voyageurs2").attr("x")})
              .style("text-anchor","end")

      // emplacement du rang de variation pour la gare 1
      svg.append("text")
              .attr("id","valeur_rangvar")
              .attr("y", 78 + margin.left)
              .attr("x", function(){return d3.select("#valeur_variation").attr("x")})
              .style("text-anchor","start")

      // emplacement du rang de varaition pour la gare 2
      svg.append("text")
              .attr("id","valeur_rangvar2")
              .attr("y", 78 + margin.left)
              .attr("x",function(){return +d3.select("#valeur_variation2").attr("x")})
              .style("text-anchor","end")

      data.forEach(function(d){
        if(d.Code_UIC == gare1){

          d3.select("#valeur_rang")
                  .text("(#"+(128-d.RangNbVoy)+")")
                  .attr("fill",couleur1)

          d3.select("#valeur_rangvar")
                  .text("(#"+(128-d.RangVariations)+")")
                  .attr("fill",couleur1)

          d3.select("#valeur_voyageurs")
                  .text(d3.format(".3s")(d.voyageurs_2016))
                  .attr("fill",couleur1)
          //.attr("class","text_colorie")

          d3.select("#valeur_variation")
                  .text(d3.format(".0%")(d.variation))
                  .attr("fill",couleur1)
          //.attr("class","text_colorie")

          d3.select("#nom1")
                  .text(d.Nom_de_la_gare)
                  .attr("fill",couleur1)
          //.attr("class","text_colorie")

          ;}
        else if(d.Code_UIC == gare2){

          d3.select("#valeur_rang2")
                  .text("(#"+(128-d.RangNbVoy)+")")
                  .attr("fill",couleur2)

          d3.select("#valeur_rangvar2")
                  .text("(#"+(128-d.RangVariations)+")")
                  .attr("fill",couleur2)

          d3.select("#valeur_voyageurs2")
                  .text(d3.format(".3s")(d.voyageurs_2016))
                  .attr("fill",couleur2)


          d3.select("#valeur_variation2")
                  .text(d3.format(".0%")(d.variation))
                  .attr("fill",couleur2)


          d3.select("#nom2")
                  .text(d.Nom_de_la_gare)
                  .attr("fill",couleur2)


          ;}
        ;})
      ;}

    function refreshWifi(div1,div2,i){

      creationRects(x_divertissements1+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_wifi",function(){if(div1[i][1]=='true'){return couleur1}else{return couleur3}})

      creationRects(x_divertissements2+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_wifi2",function(){if(div2[i][1]=='true'){return couleur2}else{return couleur3}})

      var svg_wifi = svg.append("svg")
      svg_wifi.attr("preserveAspectRatio","xMidYMid meet")
              .attr("viewBox","0 0 550 550")
              .attr("width",h_rect)
              .attr("height",h_rect)
      svg_wifi.append("path")
              .attr("id","path_wifi")
              .attr("d","M0,146.93c2.44-6.87,7.4-11.36,13.32-15.39C68,94.27,127.92,70,193.55,60.83c112-15.68,214.64,8.85,308,72.69A29,29,0,0,1,512,146.93v9c-3.81,9-9.67,15.3-20.35,15.28-4.91,0-9-2-12.87-4.72-41-28.73-85.82-49.46-134.72-60.22Q177,69.54,34.84,165.37c-4.16,2.81-8.22,5.57-13.52,5.8C10.17,171.67,4,165.34,0,155.93v-9Z")
      svg_wifi.append("path")
              .attr("id","path_wifi")
              .attr("d","M422.62,249.08c-4.29.19-8.32-1.53-12.11-4.18-36.07-25.25-75.92-41.14-119.59-46.63q-93.66-11.77-174.76,37.07c-5.13,3.09-10,6.52-15,9.8-10.2,6.68-22.21,4.66-28.6-4.82s-4-21.09,5.88-28C117.56,184.87,160.66,167,208,159.86c79.81-12,153.39,4.53,220.69,49.05a74.62,74.62,0,0,1,7.3,5.23,19.67,19.67,0,0,1,5.62,22.23C438.69,244.07,431.42,249,422.62,249.08Z")
      svg_wifi.append("path")
              .attr("id","path_wifi")
              .attr("d","M353.72,327a19.38,19.38,0,0,1-11.64-3.81c-29.65-20.36-62.49-28.94-98.27-26.26a145.19,145.19,0,0,0-72.55,25.41c-6.16,4.23-12.59,6.1-19.76,3.52-7.75-2.79-12.28-8.56-13.24-16.64s2.33-14.31,8.86-18.88a178.83,178.83,0,0,1,65.23-28.79c54.58-11.77,105.41-2.86,152,28.45,8.2,5.51,11.31,14.2,8.6,23A20,20,0,0,1,353.72,327Z")
      svg_wifi.append("path")
              .attr("id","path_wifi")
              .attr("d","M256.44,355.87A49.92,49.92,0,0,1,306,406.06c-0.08,27.33-22.74,49.8-50.13,49.7a50.15,50.15,0,0,1-49.77-50.55C206.23,377.84,228.79,355.75,256.44,355.87Z")

      svg_wifi.attr("transform","translate("+ d3.select("#valeur_wifi").attr("x") +","+d3.select("#valeur_wifi").attr("y")+")")


    }
    function refreshBaby(div1,div2,i){

      creationRects(x_divertissements1+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_babyfoot",function(){if(div1[i][1]>0){return couleur1}else{return couleur3}})

      creationRects(x_divertissements2+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_babyfoot2",function(){if(div2[i][1]>0){return couleur2}else{return couleur3}})

      var svg_babyfoot = svg.append("svg")
      svg_babyfoot.attr("preserveAspectRatio","xMidYMid meet")
              .attr("viewBox","0 0 100 100")
              .attr("width",h_rect)
              .attr("height",h_rect)
      svg_babyfoot.append("path")
              .attr("id","path_babyfoot") 		    .attr("d","M32,31a8.5,8.5,0,1,0-8.5-8.5A8.50951,8.50951,0,0,0,32,31Zm0-15a6.5,6.5,0,1,1-6.5,6.5A6.50753,6.50753,0,0,1,32,16Z")

      svg_babyfoot.append("path")
              .attr("id","path_babyfoot") 		    .attr("d","M68,31a8.5,8.5,0,1,0-8.5-8.5A8.50951,8.50951,0,0,0,68,31Zm0-15a6.5,6.5,0,1,1-6.5,6.5A6.50753,6.50753,0,0,1,68,16Z")

      svg_babyfoot.append("path")
              .attr("id","path_babyfoot")
              .attr("d","M95,43H79.65576l.34033-3.91357a.99935.99935,0,0,0-.25293-.75538l-4.5-5a1.00175,1.00175,0,0,0-.96826-.30566L68,34.47363l-6.2749-1.44824a1.0014,1.0014,0,0,0-.96826.30566l-4.5,5a.99935.99935,0,0,0-.25293.75538L56.34424,43H43.65576l.34033-3.91357a.99935.99935,0,0,0-.25293-.75538l-4.5-5a1.00244,1.00244,0,0,0-.96826-.30566L32,34.47363l-6.2749-1.44824a1.00072,1.00072,0,0,0-.96826.30566l-4.5,5a.99935.99935,0,0,0-.25293.75538L20.34424,43H5a1,1,0,0,0-1,1v6.5a1,1,0,0,0,1,1H21.65265l1.95282,1.541,1.644,21.13671-2.71728,2.74366a.99882.99882,0,0,0-.28955.70361V85a1,1,0,0,0,1,1H40.75732a1,1,0,0,0,1-1V77.625a.99882.99882,0,0,0-.28955-.70361l-2.71728-2.74366,1.644-21.13671L42.34735,51.5h15.3053l1.95282,1.541,1.644,21.13671-2.71728,2.74366a.99882.99882,0,0,0-.28955.70361V85a1,1,0,0,0,1,1H76.75732l.00428-.00085a8.49959,8.49959,0,1,0-1.62085-16.84253L76.39453,53.041,78.34735,51.5H95a1,1,0,0,0,1-1V44A1,1,0,0,0,95,43ZM6,49.5V45H20.51813l.39129,4.5Zm35.041.48291-2.229,1.75928a1.00111,1.00111,0,0,0-.37744.70752L36.7207,74.479a.99955.99955,0,0,0,.28662.78125l2.75,2.77637V84H24.24268V78.03662l2.75-2.77637a.99955.99955,0,0,0,.28662-.78125L25.56543,52.44971a1.00111,1.00111,0,0,0-.37744-.70752l-2.229-1.75928-.00836-.09613-.51507-5.97272c-.00074-.0083-.00562-.01495-.00653-.02319l-.39533-4.54468,3.81543-4.23926,5.92578,1.36768a1.00111,1.00111,0,0,0,.4502,0l5.92578-1.36768,3.81543,4.23926ZM43.09082,49.5l.3916-4.5H56.51813l.39129,4.5ZM76.74463,71a6.5,6.5,0,1,1-6.5,6.5A6.50753,6.50753,0,0,1,76.74463,71ZM77.041,49.98291l-2.229,1.75928a1.00111,1.00111,0,0,0-.37744.70752l-1.35333,17.392A8.48072,8.48072,0,0,0,71.27863,84h-11.036V78.03662l2.75-2.77637a.99955.99955,0,0,0,.28662-.78125L61.56543,52.44971a1.00111,1.00111,0,0,0-.37744-.70752l-2.229-1.75928-.00836-.09613-.51507-5.97272c-.00074-.0083-.00562-.01495-.00653-.02319l-.39533-4.54468,3.81543-4.23926,5.92578,1.36768a1.00111,1.00111,0,0,0,.4502,0l5.92578-1.36768,3.81543,4.23926ZM94,49.5H79.09131l.39453-4.5H94Z")

      svg_babyfoot.attr("transform","translate("+ d3.select("#valeur_babyfoot").attr("x") +","+d3.select("#valeur_babyfoot").attr("y")+")")
      d3.selectAll("#path_babyfoot").attr("stroke","black")
              .attr("stroke-width","2")

    }
    function refreshPower(div1,div2,i){

        creationRects(x_divertissements1+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_powerstation",function(){if(div1[i][1]>0){return couleur1}else{return couleur3}})

        creationRects(x_divertissements2+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_powerstation2",function(){if(div2[i][1]>0){return couleur2}else{return couleur3}})


        var svg_power = svg.append("svg")
        svg_power.attr("preserveAspectRatio","xMidYMid meet")
            .attr("viewBox","-6 10 80 80")
            .attr("width",h_rect)
            .attr("height",h_rect)

        svg_power.append("path")
            .attr("id","path_power")
            .attr("d","M80.6,54.5c0,1.7-1.4,3.2-3.2,3.2h-9.2c-4.4,0-7.9,3.5-7.9,7.9v0.1c0,8-6.7,14.5-14.7,14.2C38,79.6,32,73,32,65.3v-6.7  c-7.2-1.5-12.6-7.8-12.6-15.5v-8c0-1.1,0.9-2.1,2.1-2.1h3.9v-10c0-1.7,1.5-3.1,3.2-2.9c1.5,0.1,2.7,1.5,2.7,3.1v9.9h7.8v-10  c0-1.7,1.5-3.1,3.3-2.9c1.5,0.1,2.7,1.5,2.7,3.1v9.9h3.9c1.1,0,2,0.9,2,2v8c0,7.6-5.4,14-12.6,15.5v7c0,4.7,4.1,8.4,8.9,7.8  c4-0.5,6.9-4.1,6.9-8.1c0-7.7,6.3-14,14.1-14h9.3C79.2,51.3,80.6,52.8,80.6,54.5z")

        svg_power.attr("transform","translate("+ d3.select("#valeur_powerstation").attr("x") +","+d3.select("#valeur_powerstation").attr("y")+")")
        /*d3.selectAll("#path_power").attr("transform","scale(0.4) translate("+ d3.select("#valeur_powerstation").attr("x")/0.398 +","+d3.select("#valeur_powerstation").attr("y")/0.4+")")*/
    }

    function refreshPiano(div1,div2,i){

        creationRects(x_divertissements1+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_piano",function(){if(div1[i][1]>0){return couleur1}else{return couleur3}})

        creationRects(x_divertissements2+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_piano2",function(){if(div2[i][1]>0){return couleur2}else{return couleur3}})


        var svg_piano = svg.append("svg")
        svg_piano.attr("preserveAspectRatio","xMidYMid meet")
            .attr("viewBox","0 0 100 100")
            .attr("width",h_rect)
            .attr("height",h_rect)
        svg_piano.append("path")
            .attr("id","path_piano")
            .attr("d","M86.839,28.146H11.431c-0.568,0-1.028,0.46-1.028,1.028v41.145c0,0.568,0.46,1.028,1.028,1.028h75.408  c0.568,0,1.028-0.46,1.028-1.028V29.174C87.867,28.606,87.406,28.146,86.839,28.146z M20.637,67.78c0,0.839-0.68,1.519-1.519,1.519  h-5.596c-0.839,0-1.519-0.68-1.519-1.519V39.481c0-0.839,0.68-1.519,1.519-1.519h4.728c-0.108,0.209-0.175,0.443-0.175,0.694v18.228  c0,0.839,0.68,1.519,1.519,1.519h1.043V67.78z M30.013,67.78c0,0.839-0.68,1.519-1.519,1.519h-5.596  c-0.839,0-1.519-0.68-1.519-1.519v-9.376h1.036c0.839,0,1.519-0.68,1.519-1.519V38.656c0-0.252-0.067-0.485-0.175-0.694h3.805  c-0.108,0.209-0.175,0.443-0.175,0.694v18.228c0,0.839,0.68,1.519,1.519,1.519h1.106V67.78z M39.388,67.78  c0,0.839-0.68,1.519-1.519,1.519h-5.596c-0.839,0-1.519-0.68-1.519-1.519v-9.376h0.973c0.839,0,1.519-0.68,1.519-1.519V38.656  c0-0.252-0.067-0.485-0.175-0.694h4.798c0.839,0,1.519,0.68,1.519,1.519V67.78z M48.764,67.78c0,0.839-0.68,1.519-1.519,1.519  h-5.596c-0.839,0-1.519-0.68-1.519-1.519V39.481c0-0.839,0.68-1.519,1.519-1.519h4.742c-0.108,0.209-0.175,0.443-0.175,0.694v18.228  c0,0.839,0.68,1.519,1.519,1.519h1.029V67.78z M58.139,67.78c0,0.839-0.68,1.519-1.519,1.519h-5.596  c-0.839,0-1.519-0.68-1.519-1.519v-9.376h1.05c0.839,0,1.519-0.68,1.519-1.519V38.656c0-0.252-0.067-0.485-0.175-0.694h3.856  c-0.108,0.209-0.175,0.443-0.175,0.694v18.228c0,0.839,0.68,1.519,1.519,1.519h1.041V67.78z M67.515,67.78  c0,0.839-0.68,1.519-1.519,1.519H60.4c-0.839,0-1.519-0.68-1.519-1.519v-9.376h1.039c0.839,0,1.519-0.68,1.519-1.519V38.656  c0-0.252-0.067-0.485-0.175-0.694h3.889c-0.108,0.209-0.175,0.443-0.175,0.694v18.228c0,0.839,0.68,1.519,1.519,1.519h1.019V67.78z   M76.89,67.78c0,0.839-0.68,1.519-1.519,1.519h-5.596c-0.839,0-1.519-0.68-1.519-1.519v-9.376h1.06c0.839,0,1.519-0.68,1.519-1.519  V38.656c0-0.252-0.067-0.485-0.175-0.694h4.711c0.839,0,1.519,0.68,1.519,1.519V67.78z M86.266,67.78  c0,0.839-0.68,1.519-1.519,1.519h-5.596c-0.839,0-1.519-0.68-1.519-1.519V39.481c0-0.839,0.68-1.519,1.519-1.519h5.596  c0.839,0,1.519,0.68,1.519,1.519V67.78z")

        svg_piano.attr("transform","translate("+ d3.select("#valeur_piano").attr("x") +","+d3.select("#valeur_piano").attr("y")+")")
        /*d3.selectAll("#path_piano").attr("transform","scale(0.4) translate("+ d3.select("#valeur_piano2").attr("x")/0.423 +","+d3.select("#valeur_piano").attr("y")/0.4+")")*/
        //changement du denominateur de x #modif

    }

    function refreshBook(div1,div2,i){
      creationRects(x_divertissements1+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_histoire",function(){if(div1[i][1]>0){return couleur1}else{return couleur3}})

      creationRects(x_divertissements2+(i*h_rect)+(i*w_rect),y_divertissements,"valeur_histoire",function(){if(div2[i][1]>0){return couleur2}else{return couleur3}})

      var svg_book = svg.append("svg")
      svg_book.attr("preserveAspectRatio","xMidYMid meet")
              .attr("viewBox","0 0 100 100")
              .attr("width",h_rect)
              .attr("height",h_rect)
      svg_book.append("path")
              .attr("id","path_book")
              .attr("d","M 7.6875 15 A 3.0003 3.0003 0 0 0 5 18 L 5 76 A 3.0003 3.0003 0 0 0 8 79 L 39 79 C 43.349431 79 45.826032 80.37085 47.3125 83.34375 A 3.0003 3.0003 0 0 0 52.6875 83.34375 C 54.173968 80.37085 56.650569 79 61 79 L 92 79 A 3.0003 3.0003 0 0 0 95 76 L 95 18 A 3.0003 3.0003 0 0 0 92 15 L 61 15 C 56.682807 15 52.632819 17.03124 50 20.15625 C 47.367181 17.03124 43.317193 15 39 15 L 8 15 A 3.0003 3.0003 0 0 0 7.6875 15 z M 11 21 L 39 21 C 42.934608 21 47 24.81488 47 28 L 47 74.9375 C 44.656312 73.666773 41.924501 73 39 73 L 11 73 L 11 21 z M 61 21 L 89 21 L 89 73 L 61 73 C 58.075499 73 55.343688 73.666773 53 74.9375 L 53 28 C 53 24.81488 57.065392 21 61 21 z M 17.6875 26 A 3.0040663 3.0040663 0 1 0 18 32 L 38 32 A 3.0003 3.0003 0 1 0 38 26 L 18 26 A 3.0003 3.0003 0 0 0 17.6875 26 z M 61.6875 26 A 3.0040663 3.0040663 0 1 0 62 32 L 82 32 A 3.0003 3.0003 0 1 0 82 26 L 62 26 A 3.0003 3.0003 0 0 0 61.6875 26 z M 17.6875 35 A 3.0040663 3.0040663 0 1 0 18 41 L 40 41 A 3.0003 3.0003 0 1 0 40 35 L 18 35 A 3.0003 3.0003 0 0 0 17.6875 35 z M 59.6875 35 A 3.0040663 3.0040663 0 1 0 60 41 L 82 41 A 3.0003 3.0003 0 1 0 82 35 L 60 35 A 3.0003 3.0003 0 0 0 59.6875 35 z M 17.6875 44 A 3.0040663 3.0040663 0 1 0 18 50 L 40 50 A 3.0003 3.0003 0 1 0 40 44 L 18 44 A 3.0003 3.0003 0 0 0 17.6875 44 z M 59.6875 44 A 3.0040663 3.0040663 0 1 0 60 50 L 82 50 A 3.0003 3.0003 0 1 0 82 44 L 60 44 A 3.0003 3.0003 0 0 0 59.6875 44 z M 17.6875 53 A 3.0040663 3.0040663 0 1 0 18 59 L 40 59 A 3.0003 3.0003 0 1 0 40 53 L 18 53 A 3.0003 3.0003 0 0 0 17.6875 53 z M 59.6875 53 A 3.0040663 3.0040663 0 1 0 60 59 L 82 59 A 3.0003 3.0003 0 1 0 82 53 L 60 53 A 3.0003 3.0003 0 0 0 59.6875 53 z M 17.6875 62 A 3.0040663 3.0040663 0 1 0 18 68 L 40 68 A 3.0003 3.0003 0 1 0 40 62 L 18 62 A 3.0003 3.0003 0 0 0 17.6875 62 z M 59.6875 62 A 3.0040663 3.0040663 0 1 0 60 68 L 82 68 A 3.0003 3.0003 0 1 0 82 62 L 60 62 A 3.0003 3.0003 0 0 0 59.6875 62 z")

      svg_book.attr("transform"," translate("+ d3.select("#valeur_histoire").attr("x") +","+d3.select("#valeur_histoire").attr("y")+")")

    }
  </script>
</div>
</body>
